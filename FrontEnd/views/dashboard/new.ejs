<% pageTitle = "New Card" %> <% layout('./layouts/boilerplate') %> <%
customStyles ="/css/dashboard/new.css" %>

<div class="container mt-5 position-relative">
  <div id="loading-overlay" class="loading-overlay d-none">
    <div
      class="spinner-border text-light"
      role="status"
      style="width: 3rem; height: 3rem"
    ></div>
    <p class="mt-3 fs-5 fw-semibold text-white">Getting your Card Ready...</p>
  </div>

  <form
    action="/user/<%= user._id %>/card"
    method="POST"
    style="max-width: 600px"
    class="mx-auto position-relative needs-validation"
    enctype="multipart/form-data"
    novalidate
  >
    <div class="row mb-3">
      <div class="col">
        <label for="title" class="form-label">Card Title</label>
        <input
          type="text"
          class="form-control"
          name="title"
          id="title"
          placeholder="Title"
          required
        />
        <div class="invalid-feedback">Please enter a title.</div>
      </div>
      <div class="col">
        <label for="courseName" class="form-label">Course name</label>
        <input
          type="text"
          class="form-control"
          name="courseName"
          id="courseName"
          placeholder="Course name"
          required
        />
        <div class="invalid-feedback">Please enter the course name.</div>
      </div>
    </div>
    <div class="mb-3 row">
      <label for="fileUpload" class="form-label fw-bold">Upload File</label>
      <input
        class="form-control"
        type="file"
        id="fileUpload"
        name="document"
        required
      />
      <div class="invalid-feedback">Please upload a file.</div>
    </div>
    <button type="submit" class="btn btn-primary w-100">Submit</button>
  </form>
</div>

<style>
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(30, 30, 30, 0.5);
    backdrop-filter: blur(6px);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }
</style>

<script>
  const form = document.querySelector("form");
  const loadingOverlay = document.getElementById("loading-overlay");

  form.addEventListener("submit", (e) => {
    if (!form.checkValidity()) {
      e.preventDefault();
      e.stopPropagation();
    } else {
      loadingOverlay.classList.remove("d-none");
    }
    form.classList.add("was-validated");
  });
</script>
